<div id="container" *ngIf="!loading">

  <div *ngIf="dataSource.data.length > 0">
    <ion-title>{{ title }}</ion-title>
  </div>

  <div id="card-container">
    <div *ngIf="dataSource.data.length <= 0">
      <p>No Candidates Found</p>
    </div>

  <div style="display: flex; justify-content: space-between; margin: 10px">
    <div>
      <a style="cursor: pointer;" (click)="exportToExcel()">Export to Excel</a>
    </div>
    <div>
      <a style="cursor: pointer;" (click)="printTable()">Print Table</a>
    </div>
  </div>

  <div style="margin-bottom: 10px;">
    <input matInput (keyup)="applyFilter($event)" placeholder="Type to search" style="border-radius: 2px; height: 35px; border-color: lightgray;">
  </div>

  <mat-divider></mat-divider>

  <div id="table-container" style="overflow: scroll;">
        <!-- Data Table -->
        <table mat-table [dataSource]="dataSource" matSort class="mat-elevation-z8">

          <ng-container matColumnDef="roll_number">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Roll Number</th>
            <td mat-cell *matCellDef="let element">
              <!-- <input matInput *ngIf="element.isEdit" [(ngModel)]="element.rollNumber">
              <span *ngIf="!element.isEdit">{{ element.rollNumber }}</span> -->
              <span>{{ element.rollNumber }}</span>
            </td>
          </ng-container>
    
          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Name</th>
            <td mat-cell *matCellDef="let element">
              <input matInput *ngIf="element.isEdit" [(ngModel)]="element.name">
              <span *ngIf="!element.isEdit">{{ element.name }}</span>
            </td>
          </ng-container>
    
          <ng-container matColumnDef="dob">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>DOB</th>
            <td mat-cell *matCellDef="let element">
              <input 
                matInput 
                type="date" 
                *ngIf="element.isEdit" 
                [(ngModel)]="element.dateOfBirth">
                
              <span *ngIf="!element.isEdit">{{ formatDateForDatePicker(element.dateOfBirth) }}</span>
            </td>
          </ng-container>
          
    
          <ng-container matColumnDef="fname">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Father Name</th>
            <td mat-cell *matCellDef="let element">
              <input matInput *ngIf="element.isEdit" [(ngModel)]="element.fatherName">
              <span *ngIf="!element.isEdit">{{ element.fatherName }}</span>
            </td>
          </ng-container>
    
          <ng-container matColumnDef="mname">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Mother Name</th>
            <td mat-cell *matCellDef="let element">
              <input matInput *ngIf="element.isEdit" [(ngModel)]="element.motherName">
              <span *ngIf="!element.isEdit">{{ element.motherName }}</span>
            </td>
          </ng-container>
    
          <ng-container matColumnDef="email">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Email</th>
            <td mat-cell *matCellDef="let element">
              <input matInput *ngIf="element.isEdit" [(ngModel)]="element.email">
              <span *ngIf="!element.isEdit">{{ element.email }}</span>
            </td>
          </ng-container>
    
          <ng-container matColumnDef="phoneNumber">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>Contact Number</th>
            <td mat-cell *matCellDef="let element">
              <input matInput *ngIf="element.isEdit" [(ngModel)]="element.phoneNumber">
              <span *ngIf="!element.isEdit">{{ element.phoneNumber }}</span>
            </td>
          </ng-container>
    
          <ng-container matColumnDef="File">
            <th mat-header-cell *matHeaderCellDef>Image</th>
            <td mat-cell *matCellDef="let element">
              <a [href]="element.images" download="event.jpg">
                <img class="img-event" alt="Image" [src]="element.images.profilePhoto[0].imageFile.img"/>
              </a>
            </td>
          </ng-container>
    
          <ng-container matColumnDef="Action" >
            <th class="action-column" mat-header-cell *matHeaderCellDef>Action</th>
            <td class="action-column" mat-cell *matCellDef="let element; let j = index">
              <a style="cursor: pointer; margin-right: 5px;" (click)="toggleEdit(element)">
                {{ element.isEdit ? 'Save' : 'Edit' }}
              </a>
              <a style="cursor: pointer; margin-left: 5px;" (click)="deleteEvent(element, j)">Delete</a>
            </td>
          </ng-container>
    
          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
    
        <mat-divider></mat-divider>
    
        <!-- Pagination -->
         <div class="pagination" style="margin-top: 10px;">
          <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator>
         </div>
  </div>
  </div>
</div>
