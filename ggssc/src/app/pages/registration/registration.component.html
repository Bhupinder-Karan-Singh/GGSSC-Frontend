<div id="container">
  <div>
    <ion-title style="font-size: 18px;">Event : {{appService.registerEvent.eventName}}</ion-title>
  </div>

  <ion-content  *ngIf="!otpVerified">

    <form [formGroup]="sendOtpForm" (ngSubmit)="sendOtp()">
      <ion-list>

        <ion-item>
          <ion-input formControlName="email" [(ngModel)]="email" type="text" fill="solid"  labelPlacement="floating" style="margin-bottom: 10px;">
            <div slot="label">Email
              <ion-text color="primary">
              </ion-text>
            </div>
          </ion-input>
        </ion-item>
        <div *ngIf="sendOtpForm.get('email').hasError('required') && sendOtpForm.get('email').touched">
          <ion-text color="danger">Email is required.</ion-text>
        </div>
        <div *ngIf="sendOtpForm.get('email').hasError('email') && sendOtpForm.get('email').touched">
          <ion-text color="danger">Invalid email format.</ion-text>
        </div>
    
        <ion-item>
          <ion-button color="primary" style="margin-bottom: 20px;" expand="block" type="submit" [disabled]="sendOtpForm.invalid">Send Code</ion-button>
        </ion-item>

        </ion-list>
      </form>

      
    <form *ngIf="otpSent" [formGroup]="verifyForm" (ngSubmit)="verifyOtp()">
      <ion-list>

        <ion-item >
          <ion-input formControlName="otp" type="text" fill="solid"  labelPlacement="floating" style="margin-bottom: 10px;">
            <div slot="label">Enter code
              <ion-text color="primary">
              </ion-text>
            </div>
          </ion-input>
        </ion-item>
        <div style="border: none;" *ngIf="verifyForm.get('otp').hasError('required') && verifyForm.get('otp').touched">
          <ion-text color="danger">code is required.</ion-text>
        </div>
    
        <ion-item>
          <ion-button color="success" style="margin-bottom: 20px;" expand="block" type="submit" [disabled]="verifyForm.invalid">Verify Code</ion-button>
        </ion-item>

        </ion-list>
      </form>

  </ion-content>

  <ion-content  *ngIf="otpVerified">
    <form [formGroup]="registrationForm" (ngSubmit)="onSubmit()">
      <ion-list>

        <ion-item>
          <ion-input formControlName="email" [(ngModel)]="email" type="text" fill="solid"  labelPlacement="floating" style="margin-bottom: 10px;">
            <div slot="label">Email
              <ion-text color="primary">
              </ion-text>
            </div>
          </ion-input>
        </ion-item>
        <div *ngIf="registrationForm.get('email').hasError('required') && registrationForm.get('email').touched">
          <ion-text color="danger">Email is required.</ion-text>
        </div>
        <div *ngIf="registrationForm.get('email').hasError('email') && registrationForm.get('email').touched">
          <ion-text color="danger">Invalid email format.</ion-text>
        </div>
        
      <ion-item >
        <ion-input formControlName="name" type="text" fill="solid"  labelPlacement="floating" style="margin-bottom: 10px;">
          <div slot="label">Candidate Name 
            <ion-text color="primary">
            </ion-text>
          </div>
        </ion-input>
      </ion-item>
      <div style="border: none;" *ngIf="registrationForm.get('name').hasError('required') && registrationForm.get('name').touched">
        <ion-text color="danger">Name is required.</ion-text>
      </div>
  
      <ion-item>
        <ion-input formControlName="fatherName" type="text" fill="solid"  labelPlacement="floating" style="margin-bottom: 10px;">
          <div slot="label">Father's Name
            <ion-text color="primary">
            </ion-text>
          </div>
        </ion-input>
      </ion-item>
      <div *ngIf="registrationForm.get('fatherName').hasError('required') && registrationForm.get('fatherName').touched">
        <ion-text color="danger">Father's Name is required.</ion-text>
      </div>
  
      <ion-item>
        <ion-input formControlName="motherName" type="text" fill="solid"  labelPlacement="floating" style="margin-bottom: 10px;">
          <div slot="label">Mother's Name
            <ion-text color="primary">
            </ion-text>
          </div>
        </ion-input>
      </ion-item>
      <div *ngIf="registrationForm.get('motherName').hasError('required') && registrationForm.get('motherName').touched">
        <ion-text color="danger">Mother's Name is required.</ion-text>
      </div>
  
      <ion-item>
        <ion-input formControlName="phoneNumber" type="text" fill="solid"  labelPlacement="floating" style="margin-bottom: 10px;">
          <div slot="label">Phone Number
            <ion-text color="primary">
            </ion-text>
          </div>
        </ion-input>
      </ion-item>
      <div *ngIf="registrationForm.get('phoneNumber').hasError('required') && registrationForm.get('phoneNumber').touched">
        <ion-text color="danger">Phone Number is required.</ion-text>
      </div>
      <div *ngIf="registrationForm.get('phoneNumber').hasError('pattern') && registrationForm.get('phoneNumber').touched">
        <ion-text color="danger">Invalid phone number format.</ion-text>
      </div>

      <ion-item>
        
        <ion-input
        fill="solid" 
        labelPlacement="floating" 
        readonly
        (click)="openDatePicker()"
        [value]="dateOfBirth | date: 'd MMM y'"
        style="margin-bottom: 10px;">
        <div slot="label">Date Of Birth 
          <ion-text color="primary">
          </ion-text>
        </div>
        </ion-input>
        
        <ion-modal #datePickerModal>
          <ng-template>
            <ion-header>
              <ion-toolbar>
                <ion-buttons slot="start">
                  <ion-button (click)="closeDatePicker()">Cancel</ion-button>
                </ion-buttons>
                <ion-title>Date Of Birth</ion-title>
                <ion-buttons slot="end">
                  <ion-button (click)="confirmDate()">OK</ion-button>
                </ion-buttons>
              </ion-toolbar>
            </ion-header>
        
            <ion-content>
              <ion-datetime
                [presentation]="'date'"
                formControlName="dateOfBirth"
                [(ngModel)]="dateOfBirth">
              </ion-datetime>
            </ion-content>
          </ng-template>
        </ion-modal>

      </ion-item>
      <div *ngIf="registrationForm.get('dateOfBirth').hasError('required') && registrationForm.get('dateOfBirth').touched">
        <ion-text color="danger">Date of Birth is required.</ion-text>
      </div>

      <ion-item>
        <div class="image-content" style="display: flex; justify-content: center;">
          <app-candidate-image-upload [imageGuidelines]=imageGuidelines (imageChanged)="handleImageChange($event)"></app-candidate-image-upload>
        </div>
      </ion-item>
  
      <ion-item>
        <ion-button color="success" style="margin-bottom: 20px;" expand="block" type="submit" [disabled]="registrationForm.invalid">Register</ion-button>
      </ion-item>
      </ion-list>
    </form>
  </ion-content>
  
</div>



